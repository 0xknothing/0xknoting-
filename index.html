<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0xKNOTHING - The Ultimate Meme Token of Nothingness</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="https://placehold.co/32x32/e63946/f1faee?text=0x">
    <style>
        :root {
            --primary-color: #e63946; /* A vibrant red */
            --secondary-color: #457b9d; /* A muted blue */
            --dark-background: #1a1a1a;
            --light-text: #f1faee;
            --accent-green: #00ff80;
            --void-black: #000000;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--dark-background);
            color: var(--light-text);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            line-height: 1.6;
            background-image: url('https://www.transparenttextures.com/patterns/black-felt.png'); /* Subtle void pattern */
            background-repeat: repeat;
        }

        /* Global animations for chaos mode */
        @keyframes voidShift {
            0% { background-position: 0% 0%; }
            25% { background-position: 10% 10%; }
            50% { background-position: 0% 0%; }
            75% { background-position: -10% -10%; }
            100% { background-position: 0% 0%; }
        }

        /* Particle effects */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 5px;
            height: 5px;
            animation: floatAndFade 20s infinite ease-in-out;
            opacity: 0;
        }

        @keyframes floatAndFade {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateY(-100vh) translateX(50px); opacity: 0; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1; /* Ensure content is above particles */
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.95), rgba(0, 0, 0, 0.95));
            border-bottom: 2px solid var(--primary-color);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        header h1 {
            font-family: 'Orbitron', sans-serif; /* Adjusted to Orbitron for logo similarity */
            font-size: 3.5rem;
            color: #b30047; /* Darker red from the logo */
            text-shadow: 0 0 15px rgba(230, 57, 70, 0.7),
                         0 0 25px rgba(255, 0, 100, 0.5), /* Glow effect */
                         0 0 35px rgba(0, 255, 255, 0.4); /* Cyan glow from the logo */
            margin-bottom: 10px;
            letter-spacing: 5px;
            text-transform: uppercase;
            position: relative;
            animation: glitch 1s infinite alternate; /* Glitch effect */
        }

        /* Glitch effect for the main title */
        @keyframes glitch {
            0% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(0, 0);
            }
            20% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(-2px, 2px);
            }
            40% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(2px, -2px);
            }
            60% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(-1px, 1px);
            }
            80% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(1px, -1px);
            }
            100% {
                text-shadow: 0 0 15px rgba(230, 57, 70, 0.7), 0 0 25px rgba(255, 0, 100, 0.5), 0 0 35px rgba(0, 255, 255, 0.4);
                transform: translate(0, 0);
            }
        }


        header p {
            font-size: 1.2rem;
            color: var(--light-text);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .web3-section {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
            background: rgba(26, 26, 26, 0.9);
            border-bottom: 1px solid var(--secondary-color);
            margin-bottom: 20px;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .web3-status {
            background-color: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--primary-color);
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 1rem;
            color: var(--light-text);
            text-align: left;
            line-height: 1.8;
        }

        .web3-status span {
            color: var(--accent-green);
            font-weight: bold;
        }

        .web3-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(230, 57, 70, 0.4);
        }

        .web3-btn:hover:not(:disabled) {
            background-color: #ff6b7a;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(230, 57, 70, 0.6);
        }

        .web3-btn:disabled {
            background-color: #555;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
            opacity: 0.7;
        }

        /* Countdown Timer */
        .countdown-section {
            text-align: center;
            margin: 30px auto;
            padding: 20px;
            background: rgba(17, 17, 17, 0.8);
            border: 1px dashed #555;
            border-radius: 15px;
            max-width: 600px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
        }
        .countdown-section h3 {
            color: var(--accent-green);
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        .countdown-timer {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.6);
            letter-spacing: 2px;
        }
        .countdown-section p {
            margin-top: 15px;
            font-size: 0.95rem;
            color: #aaa;
        }
        
        /* NEW: Void Oracle Feed */
        .oracle-feed {
            text-align: center;
            margin: 30px auto;
            padding: 20px;
            background: rgba(17, 17, 17, 0.8);
            border: 1px solid var(--secondary-color);
            border-radius: 15px;
            max-width: 700px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
        }
        .oracle-feed h3 {
            color: var(--secondary-color);
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        .oracle-feed #oracleMessage {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            color: var(--light-text);
            font-style: italic;
            min-height: 30px; /* Prevent layout shift */
        }


        /* New Buy/Sell Interface (inspired by LILPEPE) */
        .buy-sell-container {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid #e63946;
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            max-width: 500px;
            box-shadow: 0 0 30px rgba(230, 57, 70, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .lp-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 20px;
            align-items: center;
        }
        .lp-header h2 {
            font-family: 'Orbitron', monospace;
            color: #e63946;
            font-size: 2rem;
            margin: 0;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }
        .lp-header .stage-box {
            background: #ffc107; /* Yellow */
            color: #000;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2rem;
            font-family: 'Orbitron', monospace;
        }

        .lp-price-info {
            background: rgba(0, 0, 0, 0.5);
            border: 1px dashed #555;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 25px;
            width: 100%;
            text-align: center;
        }
        .lp-price-info p {
            margin: 5px 0;
            font-size: 1.1rem;
            color: #ccc;
        }
        .lp-price-info .highlight {
            color: var(--accent-green); /* Green for prices */
            font-weight: bold;
        }
        .lp-price-info .stage-price {
            font-size: 1.4rem;
            color: #ffc107; /* Yellow for stage price */
        }

        .lp-progress-bar {
            width: 100%;
            height: 20px;
            background-color: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 25px;
            border: 1px solid var(--primary-color);
        }
        .lp-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), #ff6b7a);
            width: 0%; /* Controlled by JS */
            border-radius: 10px 0 0 10px;
            transition: width 0.5s ease-out;
        }

        .lp-stats {
            width: 100%;
            margin-bottom: 30px;
        }
        .lp-stat-line {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1rem;
            color: #aaa;
        }
        .lp-stat-line span.value {
            color: #eee;
            font-weight: bold;
        }

        .lp-input-group {
            width: 100%;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .lp-input-row {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #0d0d0d;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 10px;
        }
        .lp-input-row input {
            flex-grow: 1;
            background: none;
            border: none;
            color: #eee;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            padding: 5px;
            text-align: right;
        }
        .lp-input-row input:focus {
            outline: none;
        }
        .lp-input-row .currency-select {
            background: #222;
            color: #eee;
            border: 1px solid #555;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
        }
        .lp-input-row .max-btn {
            background: #444;
            color: #eee;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            transition: background 0.2s ease;
        }
        .lp-input-row .max-btn:hover {
            background: #666;
        }
        .lp-input-row .token-display {
            background: #1a1a1a;
            color: var(--accent-green); /* Green for token */
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Orbitron', monospace;
            font-size: 1.1rem;
            font-weight: bold;
        }

        .lp-action-button {
            width: 100%;
            background: linear-gradient(135deg, var(--primary-color), #ff6b7a);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(230, 57, 70, 0.3);
            margin-bottom: 20px;
        }
        .lp-action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(230, 57, 70, 0.4);
        }
        .lp-action-button.approve-btn {
            background: linear-gradient(135deg, var(--secondary-color), #6a9ec1);
            box-shadow: 0 4px 15px rgba(69, 123, 157, 0.3);
        }


        .lp-footer-buttons {
            display: flex;
            justify-content: space-around;
            width: 100%;
            gap: 15px;
        }
        .lp-footer-buttons button {
            flex-grow: 1;
            background: #333;
            color: #ccc;
            border: 1px solid #555;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            transition: all 0.2s ease;
        }
        .lp-footer-buttons button:hover:not(:disabled) {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* Price Chart Section */
        .price-chart-section {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--secondary-color);
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            max-width: 800px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
            position: relative; /* For background image */
            overflow: hidden; /* To contain the chart canvas */
        }

        .price-chart-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://placehold.co/800x400/000000/1a1a1a?text=Void'); /* Your space void image */
            background-size: cover;
            background-position: center;
            opacity: 0.2; /* Subtle background */
            z-index: 0;
        }


        .price-chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative; /* Above background */
            z-index: 1;
        }
        .price-chart-header h3 {
            font-family: 'Orbitron', monospace;
            color: var(--accent-green);
            font-size: 1.8rem;
            margin: 0;
        }
        .price-chart-header .current-price-display {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--light-text);
        }
        .price-chart-header .current-price-display span {
            color: var(--primary-color);
            font-weight: bold;
        }
        .price-chart-header .price-change {
            font-size: 1.1rem;
            color: var(--accent-green); /* Green for positive change */
            margin-left: 10px;
        }

        .price-chart-canvas-container {
            position: relative;
            height: 300px; /* Chart height */
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent overlay for chart */
            border: 1px dashed #444;
            border-radius: 10px;
            z-index: 1; /* Above background image */
        }

        .price-chart-canvas-container canvas {
            width: 100% !important; /* Ensure canvas fills container */
            height: 100% !important;
            display: block;
        }

        .chart-notes {
            text-align: center;
            margin-top: 15px;
            font-size: 0.95rem;
            color: #777;
            position: relative;
            z-index: 1;
        }
        
        /* NEW: Transaction History Section */
        .tx-history-section {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--secondary-color);
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            max-width: 800px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
        }
        .tx-history-section h3 {
            font-family: 'Orbitron', monospace;
            text-align: center;
            color: var(--secondary-color);
            font-size: 2.2rem;
            margin-bottom: 25px;
        }
        .tx-log {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
            border: 1px dashed #444;
            border-radius: 10px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
        }
        .tx-log::-webkit-scrollbar { width: 8px; }
        .tx-log::-webkit-scrollbar-track { background: #333; border-radius: 10px; }
        .tx-log::-webkit-scrollbar-thumb { background: var(--secondary-color); border-radius: 10px; }
        .tx-log-entry {
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 10px;
            font-size: 0.95rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .tx-log-entry .details { color: #ccc; }
        .tx-log-entry .details .tx-type-buy { color: var(--accent-green); }
        .tx-log-entry .details .tx-type-burn { color: var(--primary-color); }
        .tx-log-entry .details .tx-type-mint { color: #ffc107; }
        .tx-log-entry .explorer-link {
            color: var(--secondary-color);
            text-decoration: none;
            cursor: pointer;
            font-size: 0.9rem;
            border: 1px solid var(--secondary-color);
            padding: 3px 8px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        .tx-log-entry .explorer-link:hover {
            background: var(--secondary-color);
            color: white;
        }


        /* Stats Section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px auto;
            padding: 20px;
        }

        .stat-card {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--secondary-color);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .stat-card h4 {
            font-family: 'Orbitron', monospace;
            color: var(--primary-color);
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1.1rem;
            color: var(--light-text);
            margin: 0;
        }

        .stat-card .value {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--accent-green);
            font-weight: bold;
        }

        /* Meme Wall */
        .meme-wall-section {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--primary-color);
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
        }

        .meme-wall-section h2 {
            font-family: 'Orbitron', monospace;
            text-align: center;
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }

        .meme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .meme-card {
            background-color: #0d0d0d;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .meme-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        }

        /* NFT Card Specific Styles (for the new NFT look) */
        .nft-card-content {
            background-color: #111;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .nft-image-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1 / 1; /* Make it a square */
            overflow: hidden;
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: #222; /* Placeholder background if image loading fails */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: #555;
            font-family: 'Orbitron', monospace;
        }

        .nft-image-container img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .nft-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: var(--primary-color);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .nft-info {
            color: #eee;
        }

        .nft-collection {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #ccc;
        }

        .nft-price {
            font-size: 0.95rem;
            margin-bottom: 10px;
            color: #aaa;
        }

        .nft-price .price-value {
            color: var(--accent-green);
            font-weight: bold;
        }

        .meme-actions button {
            background-color: #333;
            color: #eee;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            margin: 5px;
            transition: background-color 0.2s ease;
        }

        .meme-actions button:hover:not(:disabled) {
            background-color: var(--primary-color);
        }

        .meme-votes {
            font-size: 0.8rem;
            color: #777;
            margin-top: 10px;
        }

        /* Most Nonsensical Meme */
        .top-meme-display {
            text-align: center;
            font-size: 1.2rem;
            color: var(--accent-green);
            margin-top: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px dashed #555;
        }

        /* NFT Minting Section */
        .nft-mint-section {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--secondary-color);
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            max-width: 600px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .nft-mint-section h2 {
            font-family: 'Orbitron', monospace;
            color: var(--accent-green);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(0, 255, 128, 0.5);
        }

        .current-nft-display {
            margin-top: 20px;
            padding: 15px;
            border: 1px dashed #444;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.4);
            display: inline-block;
        }

        .current-nft-display img {
            max-width: 150px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 2px solid #555;
        }

        .current-nft-display p {
            font-size: 1rem;
            color: #ccc;
        }

        .nft-status {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #aaa;
        }

        /* Voidpaper & How-To-Buy Section Styling (shared) */
        .voidpaper-section, .how-to-buy-section {
            background: rgba(17, 17, 17, 0.9);
            border: 1px solid var(--primary-color);
            border-radius: 15px;
            padding: 30px;
            margin: 40px auto;
            max-width: 800px;
            box-shadow: 0 0 30px rgba(230, 57, 70, 0.3);
            display: none; /* Hidden by default */
        }

        .voidpaper-section h2, .how-to-buy-section h2 {
            font-family: 'Orbitron', monospace;
            color: var(--primary-color);
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 25px;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }

        .voidpaper-section h3, .how-to-buy-section h3 {
            color: var(--accent-green);
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 10px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }
        .how-to-buy-section h2 { /* Specific color for how to buy */
            color: var(--accent-green);
            text-shadow: 0 0 10px rgba(0, 255, 128, 0.5);
        }


        .voidpaper-section p, .voidpaper-section ul,
        .how-to-buy-section p, .how-to-buy-section ol {
            color: #ccc;
            font-size: 1.05rem;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .voidpaper-section ul {
            list-style-type: '‚Äî ';
            padding-left: 20px;
        }

        .voidpaper-section li, .how-to-buy-section li {
            margin-bottom: 15px;
        }

        .how-to-buy-section ol {
            list-style-type: decimal;
            padding-left: 25px;
        }

        .how-to-buy-section ol li strong {
            color: var(--primary-color);
            font-weight: bold;
        }

        .how-to-buy-section ol li a {
            color: var(--accent-green);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .how-to-buy-section ol li a:hover {
            color: #ff6b7a;
            text-decoration: underline;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.95), rgba(0, 0, 0, 0.95));
            border-top: 2px solid var(--primary-color);
            margin-top: 50px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.5);
        }

        footer p {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 10px;
        }

        .social-links a {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin: 0 10px;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .social-links a:hover {
            color: #ff6b7a;
        }

        /* Popup */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .popup-content {
            background: var(--dark-background);
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 0 30px rgba(230, 57, 70, 0.5);
            position: relative; /* For close button */
        }
        
        .popup-content h3 {
            color: var(--primary-color);
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .popup-content p {
            color: var(--light-text);
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        .popup-buttons button, .burn-percentage-buttons button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.05rem;
            margin: 0 10px;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .popup-buttons button:hover:not(:disabled), .burn-percentage-buttons button:hover:not(:disabled) {
            background-color: #ff6b7a;
            transform: translateY(-2px);
        }

        /* NEW: Styles for Burn Popup */
        .burn-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        .burn-percentage-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .burn-percentage-buttons button {
            padding: 8px 15px;
            font-size: 0.9rem;
            background-color: #444;
        }
        .burn-input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .burn-input-container input {
            background: #0d0d0d;
            border: 1px solid #333;
            border-radius: 8px;
            color: #eee;
            padding: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            text-align: right;
            width: 70%;
        }


        /* Message Scroll Box */
        .message-scroll-box {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #555;
            border-radius: 10px;
            padding: 15px;
            height: 200px;
            overflow-y: scroll;
            margin: 20px auto;
            max-width: 800px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .message-scroll-box::-webkit-scrollbar {
            width: 8px;
        }

        .message-scroll-box::-webkit-scrollbar-track {
            background: #333;
            border-radius: 10px;
        }

        .message-scroll-box::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }

        .message-scroll-box::-webkit-scrollbar-thumb:hover {
            background: #ff6b7a;
        }

        .message-line {
            color: #bbb;
            font-size: 0.9rem;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .message-line::before {
            content: '>';
            color: var(--accent-green);
            margin-right: 8px;
        }
        
        /* NEW: Toast Notification System */
        #toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background-color: #333;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            border-left: 5px solid var(--primary-color);
            font-family: 'JetBrains Mono', monospace;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast.success { border-left-color: var(--accent-green); }
        .toast.info { border-left-color: var(--secondary-color); }
        .toast.error { border-left-color: var(--primary-color); }

        /* NEW: Trophy Room CSS */
        .trophy-grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .trophy-card {
            background: #222;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .trophy-card.locked {
            filter: grayscale(1);
            opacity: 0.6;
        }
        .trophy-card .icon { font-size: 2.5rem; }
        .trophy-card h4 { margin: 10px 0 5px; color: #ffc107; }
        .trophy-card p { font-size: 0.8rem; color: #aaa; margin: 0; }
        .progress-bar { width: 100%; background: #555; height: 5px; border-radius: 5px; margin-top: 5px; }
        .progress-fill { background: #ffc107; height: 100%; border-radius: 5px; }
        
        /* NEW: 0xKNOTHINGSCAN Popup */
        #explorerPopup .popup-content {
            max-width: 600px;
            text-align: left;
        }
        #explorerPopup h3 {
            text-align: center;
            color: var(--secondary-color);
        }
        .explorer-details p {
            background: #111;
            padding: 8px 12px;
            border-radius: 5px;
            margin-bottom: 10px;
            word-break: break-all;
        }
        .explorer-details p strong {
            color: var(--accent-green);
            min-width: 80px;
            display: inline-block;
        }


        @media (max-width: 768px) {
            header h1 {
                font-size: 2.5rem;
            }
            header p {
                font-size: 1rem;
            }
            .web3-section {
                flex-direction: column;
            }
            .countdown-timer {
                font-size: 2rem;
            }
            .lp-header h2 {
                font-size: 1.5rem;
            }
            .lp-header .stage-box {
                font-size: 1rem;
                padding: 6px 10px;
            }
            .lp-price-info p {
                font-size: 0.9rem;
            }
            .lp-input-row input, .lp-input-row .currency-select, .lp-input-row .max-btn, .lp-input-row .token-display {
                font-size: 0.9rem;
            }
            .lp-action-button {
                font-size: 1rem;
                padding: 12px 20px;
            }
            .lp-footer-buttons {
                flex-direction: column;
                gap: 10px;
            }
            .lp-footer-buttons button {
                font-size: 0.85rem;
            }
            .price-chart-header { flex-direction: column; gap: 10px; }
            .price-chart-header h3 {
                font-size: 1.4rem;
            }
            .price-chart-header .current-price-display {
                font-size: 1.2rem;
            }
            .stats-section {
                grid-template-columns: 1fr;
            }
            .meme-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            .nft-overlay {
                font-size: 2rem;
            }
            .popup-content {
                padding: 20px;
            }
            .popup-content h3 {
                font-size: 1.5rem;
            }
            .popup-content p {
                font-size: 1rem;
            }
            .popup-buttons button {
                padding: 10px 20px;
                font-size: 0.95rem;
            }
            .voidpaper-section, .how-to-buy-section {
                padding: 20px;
            }
            .voidpaper-section h2, .how-to-buy-section h2 {
                font-size: 1.8rem;
            }
            .voidpaper-section h3, .how-to-buy-section h3 {
                font-size: 1.4rem;
            }
             .voidpaper-section p, .voidpaper-section ul,
             .how-to-buy-section p, .how-to-buy-section ol {
                font-size: 0.9rem;
                padding-left: 20px;
            }
            #toast-container {
                right: 10px;
                top: 10px;
                width: calc(100% - 20px);
            }
            .tx-log-entry {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div id="particles"></div>
    <div id="toast-container"></div>

    <header>
        <h1>0xKNOTHING</h1>
        <p>The anti-utility token. No purpose. No roadmap. Pure, unadulterated nothingness. Invest your hopes and dreams here to see them vanish.</p>
    </header>

    <div class="container">
        <section class="web3-section">
            <button id="connectWalletBtn" class="web3-btn" onclick="connectWallet()">CONNECT WALLET</button>
            <button id="disconnectWalletBtn" class="web3-btn" onclick="disconnectWallet()" style="display: none; background-color: #555;">DISCONNECT</button>
            <div id="walletInfo" class="web3-status" style="display: none;">
                Wallet: <span id="walletAddress">Not Connected</span><br>
                Balance: <span id="ethBalanceDisplay">0.0000 ETH</span><br>
                Balance: <span id="usdtBalanceDisplay">0.00 USDT</span><br>
                Balance: <span id="cardBalanceDisplay">0.00 CARD</span><br>
                0xKNOTHING: <span id="knotBalance">0 0xKNOTHING</span>
            </div>
            <button id="trophyBtn" class="web3-btn" style="background-color: #ffc107; color: black; padding: 12px 15px;">üèÜ</button>
        </section>

        <section class="countdown-section">
            <h3 id="countdownStageName">Time Until Meaningless Reset</h3>
            <div class="countdown-timer" id="countdownDisplay">00:00:00</div>
            <p>Every day, the void reshapes itself. Don't expect anything different.</p>
        </section>
        
        <section class="oracle-feed">
            <h3>Void Oracle Says:</h3>
            <div id="oracleMessage">"Tomorrow‚Äôs gains are today‚Äôs lies."</div>
        </section>

        <section class="buy-sell-container">
            <div class="lp-header">
                <h2 id="lpTokenName">0xKNOTHING</h2>
                <div class="stage-box" id="currentStage">Void 1</div>
            </div>

            <div class="lp-price-info">
                <p>Next Void level: <span class="highlight stage-price" id="nextStagePrice">$0.00000000</span></p>
                <p>1 0xKNOTHING = <span class="highlight" id="knottingPrice">$0.00000000</span></p>
            </div>

            <div class="lp-stats">
                <div class="lp-stat-line">
                    <span>USD Raised:</span>
                    <span class="value" id="usdRaised">$0 / $‚àû</span>
                </div>
                <div class="lp-stat-line">
                    <span>Tokens Sold:</span>
                    <span class="value" id="tokensSold">0 / ‚àû</span>
                </div>
            </div>

            <div class="lp-progress-bar">
                <div class="lp-progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>

            <div class="lp-input-group">
                <div class="lp-input-row">
                    <input type="number" id="buyInputAmount" placeholder="0.0" min="0" step="0.000001" disabled>
                    <select id="buyCurrencySelect" class="currency-select" disabled>
                        <option value="ETH">ETH</option>
                        <option value="USDT">USDT</option>
                        <option value="CARD">CARD</option>
                    </select>
                </div>
                <div class="lp-input-row">
                    <button class="max-btn" id="maxAmountBtn" disabled>Max</button>
                    <input type="text" id="receiveTokenAmount" value="0" readonly disabled>
                    <span class="token-display">0xKNOTHING</span>
                </div>
            </div>

            <button class="lp-action-button" id="lpActionBtn" onclick="handleLpAction()">CONNECT WALLET</button>

            <div class="lp-footer-buttons">
                <button id="howToBuyBtn">HOW TO BUY NOTHING</button>
                <button id="giveawayBtn">+777K MEANINGLESS GIVEAWAY</button>
            </div>
        </section>

        <section id="howToBuySection" class="how-to-buy-section">
             <h2>HOW TO BUY 0xKNOTHING</h2>
            <ol>
                <li><strong>Step 1: Get A Wallet (For Nothing)</strong><br>
                    Download <a href="https://metamask.io/download/" target="_blank">MetaMask</a> or your preferred void-compatible wallet. This will hold your ETH (or other currencies) that you'll exchange for 0xKNOTHING, and your 0xKNOTHING tokens (which are, effectively, nothing).</li>
                <li><strong>Step 2: Fund Your Wallet (With Something)</strong><br>
                    You'll need some ETH (or USDT/CARD if supported by the exchange). You can get ETH from exchanges like Binance, Coinbase, or any other platform that deals in actual value. Transfer it to your MetaMask wallet.</li>
                <li><strong>Step 3: Connect to the Abyss (Our DApp)</strong><br>
                    On this very page, click the "CONNECT WALLET" button. Your MetaMask (or other wallet) will prompt you to connect. Approve the connection. Now your wallet is ready to participate in our glorious non-economy.</li>
                <li><strong>Step 4: Approve & Swap for Nothingness (The Transaction)</strong><br>
                    In the "Buy/Sell" section, select a currency like USDT or CARD. You'll need to click "APPROVE" first. This is a mock transaction that gives our (non-existent) contract permission to use your funds. After approval, the button will change to "BUY NOTHING". Enter the amount you wish to exchange and click it to initiate the transaction.</li>
                <li><strong>Step 5: Confirm Transaction (And Your Regret)</strong><br>
                    Your wallet will pop up asking you to confirm the transaction and gas fees. Review the details. If you're truly committed to embracing nothingness, confirm the transaction. The tokens will appear in your wallet shortly.</li>
                <li><strong>Step 6: Add 0xKNOTHING to Your Wallet (If You Must)</strong><br>
                    Since 0xKNOTHING is, well, nothing, you might need to manually add the token to your MetaMask to see it. Use our contract address (if we ever bothered to deploy one that works) and the token symbol "0xKNOTHING" with 18 decimals.
                    <br><strong>(Disclaimer: We haven't deployed a contract yet. It's too much effort for nothing.)</strong></li>
            </ol>
            <p style="text-align: center; font-style: italic;">Congratulations! You've successfully acquired nothing. We told you so.</p>
        </section>
        
        <div style="display: flex; justify-content: center; gap: 20px; margin: 30px auto;">
            <button id="burnToVoidBtn" title="Burn your 0xKNOTHING tokens to achieve ultimate nothingness. This action is irreversible." class="web3-btn" style="background-color: #333; border: 1px solid #555;" disabled>BURN TO VOID</button>
            <button id="spreadFudBtn" title="Spread Fear, Uncertainty, and Doubt for no reason at all." class="web3-btn" style="background-color: #333; border: 1px solid #555;" onclick="spreadFud()">SPREAD FUD</button>
        </div>
        

        <section class="message-scroll-box" id="messageScroll">
        </section>

        <section class="price-chart-section">
            <div class="price-chart-header">
                <h3>0xKNOTHING Price Chart</h3>
                <div class="current-price-display">
                    Current Price: <span id="currentKnotPrice">$0.00000068</span>
                    <span id="priceChangePercent" class="price-change">+‚àû%</span>
                </div>
            </div>
            <div class="price-chart-canvas-container">
                <canvas id="priceChart"></canvas>
            </div>
            <p class="chart-notes">
                * Chart shows the price of our hopes and dreams, not actual trading data.
            </p>
        </section>
        
        <section class="tx-history-section">
            <h3>Transaction History (for Nothing)</h3>
            <div class="tx-log" id="txLogContainer">
                <!-- Dynamically populated by JS -->
                <p style="text-align:center; color: #777;">Connect wallet to see your history of questionable decisions.</p>
            </div>
        </section>

        <section class="stats-section">
            <div class="stat-card">
                <h4>Market Cap</h4>
                <p id="marketCap" class="value">Undefined</p>
            </div>
            <div class="stat-card">
                <h4>24h Volume</h4>
                <p id="volume24h" class="value">Tears of Regret</p>
            </div>
            <div class="stat-card">
                <h4>Holders</h4>
                <p id="holdersCount" class="value">Nobody + You</p>
            </div>
            <div class="stat-card">
                <h4>LP Status</h4>
                <p id="lpVolume" class="value">0.000000 LP (Glitchy Pool)</p>
            </div>
            <div class="stat-card">
                <h4>Last Activity</h4>
                <p id="lastActivity" class="value">Block ??? - Random Event (0x...)</p>
            </div>
            <div class="stat-card">
                <h4>Current Price</h4>
                <p id="currentPrice" class="value">$0.00000068</p>
            </div>
        </section>

        <section class="meme-wall-section">
            <h2>The Wall of Nonsense NFTs</h2>
            <div class="meme-grid" id="memeGrid">
                </div>
            <div class="top-meme-display" id="mostNonsensicalMeme">
                Most Nonsensical Meme Today: "My Brain Cell Count"
            </div>
        </section>

        <section class="nft-mint-section">
            <h2>Mint Your Own Nothing NFT</h2>
            <p>Embrace the void. Own a piece of digital non-existence. Each NFT is a unique representation of futility.</p>
            <button id="mintNftBtn" class="web3-btn" onclick="mintNft()" disabled>Mint A Nothing NFT (Cost: Gas Fees + Your Sanity)</button>
            <div class="current-nft-display">
                <img id="currentNftImage" src="https://placehold.co/150x150/333333/FFFFFF?text=NFT" alt="Your Minted NFT" onerror="this.onerror=null;this.src='https://placehold.co/150x150/333333/FFFFFF?text=Error';">
                <p id="currentNftText">Your NFT: Nothing yet. Connect wallet to see your future regret.</p>
            </div>
            <p id="nftMintStatus" class="nft-status">Ready to waste your gas...</p>
        </section>

        <section class="voidpaper-section" id="voidpaperSection">
            <h2>The Voidpaper (or lack thereof)</h2>
            <p>Welcome, seeker of truth, to the Voidpaper. A document meticulously crafted to explain absolutely nothing about 0xKNOTHING. Our philosophy is simple: there is no philosophy. Our technology is groundbreaking: it doesn't exist. Our community is thriving: in their own heads.</p>

            <h3>1. Introduction to the Abyss</h3>
            <p>0xKNOTHING is not a cryptocurrency. It is not a meme coin. It is not even a concept. It is the digital embodiment of that nagging feeling in the back of your mind that everything is meaningless. We've tokenized the void, and frankly, we're not sure why.</p>

            <h3>2. Non-existent Tokenomics</h3>
            <ul>
                <li>Total Supply: ‚àû (It grows as fast as your disappointment)</li>
                <li>Burn Mechanism: Every transaction burns a small piece of your hope.</li>
                <li>Staking: You can stake your tokens, and we'll stake ours that you'll gain nothing.</li>
                <li>Liquidity: As volatile as your life choices.</li>
                <li>Utility: Less than zero. This token actively subtracts utility from your life.</li>
            </ul>

            <h3>3. The Anti-Roadmap (or The Road to Nowhere)</h3>
            <p>Our roadmap is a blank canvas, perfectly reflecting our commitment to going nowhere. We plan to achieve absolutely nothing, consistently, for an indefinite period. Key milestones include:</p>
            <ul>
                <li>**Q3 2025: Continue to exist (maybe).**</li>
                <li>**Q4 2025: Fail to launch any meaningful partnerships.**</li>
                <li>**2026: Further decentralize the feeling of despair.**</li>
                <li>**Future: Achieve ultimate oblivion.**</li>
                <li>**Forever: Continue to be nothing.**</li>
            </ul>

            <h3>4. Our Non-existent Team</h3>
            <p>Our team is comprised of highly experienced individuals in the art of doing nothing. We are anonymous, not because we fear regulations, but because we fear accountability. We are passionate about... well, we're not passionate about anything really.</p>

            <h3>5. Join the Void (Don't)</h3>
            <p>Don't join our community. Don't invest. Don't believe the hype (there isn't any). Just observe the nothingness, and perhaps, find a strange comfort in its absolute pointlessness.</p>

            <p style="text-align: center; margin-top: 30px; font-style: italic;">Thank you for wasting your time reading the Voidpaper. You're now one step closer to embracing true Nothingness.</p>
        </section>

        <button class="web3-btn" onclick="toggleVoidpaper()" style="display: block; margin: 30px auto;">READ THE VOIDPAPER</button>
    </div>

    <footer>
        <p>&copy; 2025 0xKNOTHING. All rights reserved. (We think. Who cares anyway?)</p>
        <div class="social-links">
            <a href="#" target="_blank">X</a> |
            <a href="#" target="_blank">Telegram</a> |
            <a href="#" target="_blank">Discord</a>
        </div>
         <button id="darkModeToggle" onclick="toggleDarkMode()" style="margin-top: 15px; background-color: #333; border: 1px solid #555;">Darkmode</button>
    </footer>

    <!-- Main Action Popup -->
    <div id="actionPopup" class="popup-overlay">
        <div class="popup-content" id="popupContent">
            <!-- Content is dynamically generated by JS -->
        </div>
    </div>
    
    <!-- Trophy Room Popup -->
    <div id="trophyRoomPopup" class="popup-overlay" style="align-items: flex-start; padding-top: 5vh; display: none;">
        <div class="popup-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
            <h3>üèÜ Hall of Nothingness</h3>
            <p>Total Points of Futility (PoF): <span id="pofDisplay">0</span></p>
            <div id="trophyGrid" class="trophy-grid-container">
                <!-- Dynamically populated by JS -->
            </div>
            <button class="web3-btn" style="margin-top: 20px;" onclick="hideTrophyRoom()">Close</button>
        </div>
    </div>
    
    <!-- NEW: Explorer Popup -->
    <div id="explorerPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>0xKNOTHINGSCAN</h3>
            <div id="explorerDetails" class="explorer-details">
                <!-- Explorer details populated by JS -->
            </div>
            <button class="web3-btn" style="margin-top: 20px;" onclick="hideExplorerPopup()">Close</button>
        </div>
    </div>


    <script>
        /**
         * NOTE ON FINANCIAL CALCULATIONS:
         * This simulation uses standard JavaScript numbers for calculations. In a real-world financial application (DApp),
         * this is risky due to potential floating-point precision errors (e.g., 0.1 + 0.2 !== 0.3).
         * Production DApps use libraries like BigNumber.js to handle mathematical operations on currency values
         * safely and accurately, often by working with values as large integers (e.g., wei instead of ETH).
         * For this simulation, standard numbers are sufficient.
         */

        // --- NEW: Achievements System ---
        const allAchievements = {
            'first_buy': { name: 'Swapped Nothing for Nothing', description: "You made your first, questionable purchase of 0xKNOTHING.", points: 10 },
            'first_burn': { name: 'Burned For No Reason', description: "You sent tokens to the void, achieving peak nothingness.", points: 15 },
            'read_the_void': { name: 'Reading Into Nothing', description: "You opened the VOIDPAPER knowing full well there's nothing in it.", points: 5 },
            'mint_a_nothing': { name: 'Mint A Nothing', description: "You intentionally minted a Nothing NFT.", points: 10 },
            'claimed_nothing': { name: 'Claimed Nothing', description: "You clicked the '+777K GIVEAWAY' and got nothing, as promised.", points: 8 },
            'burning_curiosity': { name: 'Burning Curiosity', description: "You tried to burn tokens even when you had none to burn.", points: 6 },
            'voted_in_void': { name: 'Voted in Void DAO', description: "You voted on a meme, influencing the collective meaninglessness.", points: 7 },
            'hall_of_futility': { name: 'Hall of Futility', description: "You opened the Hall of Nothingness to view your pointless rewards.", points: 5 },
            'fud_initiator': { name: 'FUD Initiator', description: "You clicked the 'Spread FUD' button. Welcome to the dark side.", points: 10 },
            'devtools_detective': { name: 'DevTools Detective', description: "You tried to look under the hood. There's nothing here either.", points: 15 },
            'dark_mode_connoisseur': { name: 'Dark Mode Connoisseur', description: "You tried to change the theme. It didn't work.", points: 3 },
            'popup_addict': { name: 'Popup Addict', description: "Opened any popup 5 times within 2 minutes.", points: 7, type: 'counter', target: 5 },
        };
        
        // NEW: Oracle Messages
        const oracleMessages = [
            "Tomorrow‚Äôs gains are today‚Äôs lies.",
            "Liquidity is imaginary. So is your future.",
            "FOMO is a feature, not a bug.",
            "The chart is just a random line we drew.",
            "We are all exit liquidity in the grand scheme of things.",
            "Breaking: Price does something. Or maybe nothing.",
            "The only thing going to the moon is your disappointment.",
            "Buy the dip. And the dip after that. And the one after that.",
            "Our roadmap leads directly to your parents' basement."
        ];
        
        // NEW: FUD Messages
        const fudMessages = [
            "Rug confirmed. Just vibes.",
            "Liquidity gone. Marketing never existed.",
            "Dev sold his bags. Oh wait, there were no bags.",
            "This is a social experiment to see who clicks buttons.",
            "I heard the contract is just a 'hello world' script.",
            "The team is one guy and his cat. The cat is the CEO."
        ];
        
        // NEW: Paradoxical Stage Names
        const stageNames = [
            'Void 1', 'Void Again', 'ReVoid', 'Eternal Void', 'The Final Nothing', 'Return to Nothing', 'Void 1 (Seriously this time)', 'The Void Strikes Back'
        ];

        // Function to show toast notifications for better user feedback
        function showToast(message, type = 'info', duration = 5000) { // types: info, success, error
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            container.appendChild(toast);

            setTimeout(() => { toast.classList.add('show'); }, 10);

            setTimeout(() => {
                toast.classList.remove('show');
                toast.addEventListener('transitionend', () => {
                    if (toast.parentElement) container.removeChild(toast);
                });
            }, duration);
        }

        // --- Simulation Constants ---
        const SIMULATED_PRICES = {
            ETH: 3000, // USD per ETH
            USDT: 1,   // USD per USDT
            CARD: 0.45 // USD per CARD
        };

        // Global Web3 variables
        let provider, signer, userAddress;
        let isWalletConnected = false;
        let isTransactionPending = false; 
        let approvedCurrencies = {}; // For tracking token approvals
        let txHistory = []; // For transaction log

        // Helper to get numbers from localStorage safely
        function getStoredNumber(key, defaultValue) {
            const storedValue = localStorage.getItem(key);
            if (storedValue !== null && storedValue !== undefined && !isNaN(parseFloat(storedValue))) {
                return parseFloat(storedValue);
            }
            return defaultValue;
        }
        
        function getStoredObject(key, defaultValue) {
            const storedValue = localStorage.getItem(key);
            try {
                if (storedValue) return JSON.parse(storedValue);
            } catch (e) {
                console.error("Failed to parse stored object:", e);
            }
            return defaultValue;
        }
        
        let currentKnotBalance = getStoredNumber('0xknothing_knotBalance_v3', 0); 
        let currentEthBalance = getStoredNumber('0xknothing_ethBalance_v3', -1);
        let currentUsdtBalance = getStoredNumber('0xknothing_usdtBalance_v3', -1);
        let currentCardBalance = getStoredNumber('0xknothing_cardBalance_v3', -1);

        let totalUsdRaised = getStoredNumber('0xknothing_usdRaised_v3', 123456.78);
        let totalTokensSold = getStoredNumber('0xknothing_tokensSold_v3', 987654321);
        let currentStage = getStoredNumber('0xknothing_currentStage_v3', 1);
        let knotPrice = calculateKnotPrice(currentStage);
        
        // --- Achievements System ---
        let userPlayerData; 
        let popupOpenTimestamps = []; // For 'Popup Addict' achievement
        
        function initializePlayerData() {
            let playerData;
            try {
                playerData = JSON.parse(localStorage.getItem('0xknothing_playerData_v3')); // Use new key for new structure
                if (!playerData || typeof playerData.pof === 'undefined') { 
                    throw new Error("Invalid player data");
                }
                // Ensure all achievements from the config exist in the player data
                for (const id in allAchievements) {
                    if (!playerData.achievements[id]) {
                         playerData.achievements[id] = { unlocked: false, progress: 0 };
                    }
                }

            } catch (e) {
                playerData = {
                    pof: 0, // Points of Futility
                    achievements: {}
                };
                for (const id in allAchievements) {
                    playerData.achievements[id] = { unlocked: false, progress: 0 };
                }
            }
            localStorage.setItem('0xknothing_playerData_v3', JSON.stringify(playerData));
            return playerData;
        }

        function unlockAchievement(id) {
            if (userPlayerData && userPlayerData.achievements[id] && !userPlayerData.achievements[id].unlocked) {
                userPlayerData.achievements[id].unlocked = true;
                userPlayerData.pof += allAchievements[id].points;
                localStorage.setItem('0xknothing_playerData_v3', JSON.stringify(userPlayerData));
                showToast(`üèÜ Achievement Unlocked: ${allAchievements[id].name}`, 'success');
                updatePofDisplay();
            }
        }
        
        function incrementAchievementProgress(id) {
            if (userPlayerData && userPlayerData.achievements[id] && !userPlayerData.achievements[id].unlocked) {
                const achConfig = allAchievements[id];
                if (achConfig.type === 'counter') {
                    userPlayerData.achievements[id].progress++;
                    if (userPlayerData.achievements[id].progress >= achConfig.target) {
                        unlockAchievement(id);
                    }
                    localStorage.setItem('0xknothing_playerData_v3', JSON.stringify(userPlayerData));
                }
            }
        }

        function updatePofDisplay() {
            const pofElement = document.getElementById('pofDisplay');
            if(pofElement && userPlayerData) pofElement.textContent = userPlayerData.pof;
        }

        // --- Achievements System: DevTools Check ---
        const devtools = /./;
        devtools.toString = function() {
            unlockAchievement('devtools_detective');
            return ' ';
        }
        console.log('%cSTOP!', "color:red; font-size:20px; font-weight: bold;");
        console.log("You‚Äôre staring into the void of the console. You found... nothing, as promised.");
        console.log('%c', devtools);


        function calculateKnotPrice(stage) {
            // This function creates a somewhat unpredictable price based on the stage number
            if (stage <= 10) return 0.00000001 * Math.pow(1.8, stage - 1);
            if (stage <= 20) return 0.00000001 * Math.pow(1.8, 9) + (stage - 10) * 0.0000005;
            // After stage 20, it becomes chaotic
            const basePrice = 0.00000001 * Math.pow(1.8, 9) + 10 * 0.0000005;
            const randomFactor = Math.random();
            if (randomFactor < 0.3) return basePrice * (1 + Math.random() * 0.5); // Price pump
            if (randomFactor < 0.6) return basePrice * (0.5 + Math.random() * 0.5); // Price dump
            if (randomFactor < 0.8) return Math.random() * 0.0001; // Extreme volatility
            return Infinity; // Rug pull
        }

        const memes = [
             { id: 'nft404_1', collection: 'The Void Collection', number: '#4?4', price: '‚àû 0xKNOTHING (Coming Never)', mintText: 'Mint Confusion', img: 'https://placehold.co/250x250/111111/e63946?text=4?4', votes: getStoredNumber('meme_votes_nft404_1', 0) },
             { id: 'misspelled_‚àû', collection: 'Misspelled Dreams', number: '#‚àû', price: 'Your Soul (Sold Out)', mintText: 'Soul Not Found', img: 'https://placehold.co/250x250/111111/e63946?text=INFINTY', votes: getStoredNumber('meme_votes_misspelled_‚àû', 0) },
             { id: 'oxknothing_0', collection: '0xKNOTHING Original', number: '#0000', price: '0.000 ETH (Not for sale)', mintText: 'Mint Nothing (Unavailable)', img: 'https://placehold.co/250x250/000000/1a1a1a?text=VOID', votes: getStoredNumber('meme_votes_oxknothing_0', 0) },
             { id: 'nft404_2', collection: 'The Void Collection', number: '#404', price: 'Œû ??? (Maybe)', mintText: 'Attempt Mint?', img: 'https://placehold.co/250x250/111111/e63946?text=404', votes: getStoredNumber('meme_votes_nft404_2', 0) },
             { id: 'lost_cause', collection: 'Lost Cause Series', number: '#500', price: '1.000 ETH (Not For You)', mintText: 'Mint Disappointment', img: 'https://placehold.co/250x250/111111/e63946?text=NOPE', votes: getStoredNumber('meme_votes_lost_cause', 0) },
             { id: 'digital_dust', collection: 'Digital Dust', number: '#999', price: 'FREE (But Costly)', mintText: 'Claim Your Dust', img: 'https://placehold.co/250x250/111111/e63946?text=DUST', votes: getStoredNumber('meme_votes_digital_dust', 0) }
        ];

        let priceChart;

        const messages = ["There is no plan. There never was.", "You're waiting for something that will never come.", "No utility. No purpose. Just vibes of emptiness.", "Even this message means nothing.", "Stay unready. Stay unknowing.", "You came here for meaning? That's cute.", "The real value is in the absolute void.", "We 0xKNOT what we're doing. Do you?", "Imagine a meme. Now delete it. That's us.", "0xKNOTHING: not even trying since never."];

        function appendRandomMessage() {
            const container = document.getElementById("messageScroll");
            if(!container) return;
            const msg = document.createElement("div");
            msg.className = "message-line";
            msg.textContent = messages[Math.floor(Math.random() * messages.length)];
            container.appendChild(msg);
            while (container.children.length > 20) {
                container.removeChild(container.firstChild);
            }
            container.scrollTop = container.scrollHeight;
        }

        document.addEventListener("DOMContentLoaded", function () {
            userPlayerData = initializePlayerData();
            
            createParticles();
            setInterval(updateRealtimeCountdown, 1000);
            updateRealtimeCountdown();

            for (let i = 0; i < 3; i++) { setTimeout(appendRandomMessage, i * 1000); }
            setInterval(appendRandomMessage, 4000);
            
            setInterval(updateOracleFeed, 20000);
            updateOracleFeed();

            setInterval(updateStats, 10000);
            updateStats();

            populateMemeWall();
            updateMostNonsensicalMeme();
            setInterval(updateMostNonsensicalMeme, 30000);

            updateLPInterface();

            document.getElementById('buyInputAmount').addEventListener('input', calculateReceiveAmount);
            document.getElementById('buyCurrencySelect').addEventListener('change', () => {
                calculateReceiveAmount();
                updateLpActionButton(); // Update button on currency change
            });
            document.getElementById('maxAmountBtn').addEventListener('click', setMaxBuyAmount);

            document.getElementById('howToBuyBtn').addEventListener('click', toggleHowToBuySection);
            
            document.getElementById('giveawayBtn').addEventListener('click', () => {
                unlockAchievement('claimed_nothing');
                showToast("üéâ Congratulations! You just won... nothing! As expected.", 'success');
                appendRandomMessage();
            });
            document.getElementById('burnToVoidBtn').addEventListener('click', () => {
                if (!isWalletConnected || isTransactionPending) {
                    if (currentKnotBalance <= 0) {
                        unlockAchievement('burning_curiosity');
                        showToast("You have nothing to burn. It's already perfect nothingness.", 'info');
                    }
                    return;
                };
                showPopup('burn');
            });
            
            document.getElementById('trophyBtn').addEventListener('click', () => {
                unlockAchievement('hall_of_futility');
                renderTrophyRoom();
                document.getElementById('trophyRoomPopup').style.display = 'flex';
            });

            initializeChart();
            setInterval(updateChartData, 2000);
            
            if (localStorage.getItem('0xknothing_isConnected_v3') === 'true') {
                 connectWallet(true); // silent connect
            }
        });

        // Web3 Functions
        async function connectWallet(isSilent = false) {
            if (isWalletConnected || isTransactionPending) return;
            
            const connectBtn = document.getElementById('connectWalletBtn');
            connectBtn.disabled = true;
            connectBtn.textContent = 'CONNECTING...';

            if (!isSilent) showToast("Awaiting connection from wallet...", 'info');
            
            setTimeout(() => {
                isWalletConnected = true;
                localStorage.setItem('0xknothing_isConnected_v3', 'true');
                userAddress = localStorage.getItem('0xknothing_userAddress_v3') || "0x" + [...Array(40)].map(() => Math.floor(Math.random() * 16).toString(16)).join('');
                localStorage.setItem('0xknothing_userAddress_v3', userAddress);

                // Simulate new random balances only if they haven't been set before
                if (currentEthBalance < 0) currentEthBalance = Math.random() * 2.0 + 0.05;
                if (currentUsdtBalance < 0) currentUsdtBalance = Math.random() * 5000 + 100;
                if (currentCardBalance < 0) currentCardBalance = Math.random() * 10000 + 500;
                
                approvedCurrencies = getStoredObject('0xknothing_approvedCurrencies_v3', {});
                txHistory = getStoredObject('0xknothing_txHistory_v3', []);

                updateWalletUI();
                renderTxHistory();
                
                updateLpActionButton();
                
                enableLPButtons();
                if (!isSilent) showToast("Wallet connected to the void.", 'success');
                
                connectBtn.style.display = 'none';
                document.getElementById('disconnectWalletBtn').style.display = 'inline-block';
                
                appendRandomMessage();

            }, isSilent ? 0 : 1500);
        }
        
        function disconnectWallet() {
            isWalletConnected = false;
            userAddress = undefined;
            approvedCurrencies = {};
            txHistory = [];
            
            // Clear all relevant session data from local storage
            localStorage.removeItem('0xknothing_isConnected_v3');
            localStorage.removeItem('0xknothing_userAddress_v3');
            localStorage.removeItem('0xknothing_approvedCurrencies_v3');
            localStorage.removeItem('0xknothing_txHistory_v3');
            localStorage.removeItem('0xknothing_knotBalance_v3');
            localStorage.removeItem('0xknothing_ethBalance_v3');
            localStorage.removeItem('0xknothing_usdtBalance_v3');
            localStorage.removeItem('0xknothing_cardBalance_v3');
            
            // Reset achievement data
            localStorage.removeItem('0xknothing_playerData_v3');
            userPlayerData = initializePlayerData(); // Re-initialize to a fresh state
            
            // Reset balances
            currentKnotBalance = 0;
            currentEthBalance = -1;
            currentUsdtBalance = -1;
            currentCardBalance = -1;
            
            // Update UI elements to reflect disconnected state
            const connectBtn = document.getElementById('connectWalletBtn');
            connectBtn.style.display = 'inline-block';
            connectBtn.disabled = false;
            connectBtn.textContent = 'CONNECT WALLET';
            document.getElementById('disconnectWalletBtn').style.display = 'none';
            
            document.getElementById('walletInfo').style.display = 'none';
            
            const lpActionBtn = document.getElementById('lpActionBtn');
            lpActionBtn.textContent = 'CONNECT WALLET';
            lpActionBtn.onclick = () => connectWallet();
            lpActionBtn.classList.remove('approve-btn');
            
            // Disable interactive elements
            document.getElementById('buyInputAmount').disabled = true;
            document.getElementById('buyCurrencySelect').disabled = true;
            document.getElementById('maxAmountBtn').disabled = true;
            document.getElementById('receiveTokenAmount').disabled = true;
            document.getElementById('mintNftBtn').disabled = true;
            document.getElementById('burnToVoidBtn').disabled = true;
            
            document.getElementById('txLogContainer').innerHTML = '<p style="text-align:center; color: #777;">Connect wallet to see your history of questionable decisions.</p>';
            
            showToast("Wallet disconnected. The void awaits your return.", 'info');
        }
        
        function updateWalletUI() {
            if(!document.getElementById("walletAddress")) return;

            document.getElementById("walletAddress").textContent = userAddress.slice(0, 6) + "..." + userAddress.slice(-4);
            
            document.getElementById("ethBalanceDisplay").textContent = `${currentEthBalance.toFixed(4)} ETH`;
            document.getElementById("usdtBalanceDisplay").textContent = `${currentUsdtBalance.toFixed(2)} USDT`;
            document.getElementById("cardBalanceDisplay").textContent = `${currentCardBalance.toFixed(2)} CARD`;
            document.getElementById("knotBalance").textContent = `${currentKnotBalance.toLocaleString()} 0xKNOTHING`;
            
            document.getElementById("walletInfo").style.display = "block";
            
            // Persist simulated balances to localStorage to maintain state on refresh
            localStorage.setItem('0xknothing_knotBalance_v3', currentKnotBalance);
            localStorage.setItem('0xknothing_ethBalance_v3', currentEthBalance);
            localStorage.setItem('0xknothing_usdtBalance_v3', currentUsdtBalance);
            localStorage.setItem('0xknothing_cardBalance_v3', currentCardBalance);


            const burnBtn = document.getElementById('burnToVoidBtn');
            burnBtn.disabled = currentKnotBalance <= 0;
        }

        function enableLPButtons() {
            document.getElementById('buyInputAmount').disabled = false;
            document.getElementById('buyCurrencySelect').disabled = false;
            document.getElementById('maxAmountBtn').disabled = false;
            document.getElementById('receiveTokenAmount').disabled = false;
            document.getElementById('mintNftBtn').disabled = false;
        }

        function updateLPInterface() {
            let stageName = stageNames[(currentStage - 1) % stageNames.length];
            document.getElementById("currentStage").textContent = stageName;
            document.getElementById("countdownStageName").textContent = `Time Until ${stageName} Resets`;

            let nextStagePrice = knotPrice * (1 + 0.1 * Math.random());
            
            if (knotPrice === Infinity || knotPrice <= 0) {
                document.getElementById("nextStagePrice").textContent = `$‚àû (Impossible)`;
                document.getElementById("knottingPrice").textContent = `$‚àû`;
            } else {
                document.getElementById("nextStagePrice").textContent = `$${nextStagePrice.toFixed(8)}`;
                document.getElementById("knottingPrice").textContent = `$${knotPrice.toFixed(8)}`;
            }

            document.getElementById("usdRaised").textContent = `$${totalUsdRaised.toLocaleString(undefined, { maximumFractionDigits: 0 })} / $‚àû`;
            document.getElementById("tokensSold").textContent = `${totalTokensSold.toLocaleString(undefined, { maximumFractionDigits: 0 })} / ‚àû`;
            
            const progress = (totalTokensSold % 1000000000) / 1000000000 * 100;
            document.getElementById("progressFill").style.width = `${progress}%`;
            
            calculateReceiveAmount();
        }

        function calculateReceiveAmount() {
            const inputAmount = parseFloat(document.getElementById('buyInputAmount').value);
            if (isNaN(inputAmount) || inputAmount <= 0) {
                document.getElementById('receiveTokenAmount').value = 0;
                return;
            }
            const selectedCurrency = document.getElementById('buyCurrencySelect').value;
            let usdEquivalent = inputAmount * SIMULATED_PRICES[selectedCurrency];
            
            let receivedKnot = (knotPrice === Infinity || knotPrice <= 0) ? 0 : usdEquivalent / knotPrice;
            document.getElementById('receiveTokenAmount').value = receivedKnot.toLocaleString(undefined, { maximumFractionDigits: 0 });
        }

        function setMaxBuyAmount() {
            if (!isWalletConnected) return;
            const selectedCurrency = document.getElementById('buyCurrencySelect').value;
            let maxAmount = 0;
            
            switch (selectedCurrency) {
                case 'ETH': 
                    maxAmount = currentEthBalance > 0.005 ? currentEthBalance - 0.005 : 0; // Leave a bit for gas
                    break;
                case 'USDT': 
                    maxAmount = currentUsdtBalance;
                    break;
                case 'CARD': 
                    maxAmount = currentCardBalance;
                    break;
            }
            
            document.getElementById('buyInputAmount').value = maxAmount > 0 ? maxAmount.toFixed(4) : 0;
            calculateReceiveAmount();
        }

        function setPendingState(isPending) {
            isTransactionPending = isPending;
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => {
                // Don't disable popup close buttons
                if (btn.id !== 'popupCancelBtn' && !btn.onclick?.toString().includes('hideTrophyRoom') && !btn.onclick?.toString().includes('hideExplorerPopup')) {
                    btn.disabled = isPending;
                }
            });
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => input.disabled = isPending);

            if (!isPending && isWalletConnected) {
                enableLPButtons();
                document.getElementById('lpActionBtn').disabled = false;
                document.getElementById('disconnectWalletBtn').disabled = false;
                if (currentKnotBalance > 0) document.getElementById('burnToVoidBtn').disabled = false;
            } else if (!isPending && !isWalletConnected) {
                document.getElementById('connectWalletBtn').disabled = false;
            }
        }

        async function mintNft() {
            if (!isWalletConnected || isTransactionPending) {
                showToast("Connect wallet first or wait for the current transaction.", 'error');
                return;
            }
            
            const gasFee = 0.008 + Math.random() * 0.005;
            if (currentEthBalance < gasFee) {
                showToast(`Insufficient ETH for gas! Need ~${gasFee.toFixed(4)} ETH.`, 'error');
                return;
            }
            
            setPendingState(true);
            showToast("Submitting mint transaction to the void...", 'info', 10000);
            
            setTimeout(() => {
                const txHash = "0x" + Math.random().toString(16).substr(2, 64);
                if (Math.random() < 0.15) { 
                    showToast("Minting failed. The void is not impressed.", 'error');
                    addTxLog('mint', { name: "Failed Mint Attempt", cost: gasFee, success: false, txHash });
                    setPendingState(false);
                    return;
                }

                unlockAchievement('mint_a_nothing');
                currentEthBalance -= gasFee;
                const nftNames = ["Void Fragment", "Eternal Echo", "Quantum Blankness", "Unseen Horizon", "Zero Point Entity", "The Invisible Pixel"];
                const randomNftName = nftNames[Math.floor(Math.random() * nftNames.length)];
                document.getElementById('currentNftText').textContent = `Your NFT: "${randomNftName}"`;
                document.getElementById('currentNftImage').src = `https://placehold.co/150x150/00ff80/000000?text=${encodeURIComponent(randomNftName.split(' ')[0])}`;
                
                updateWalletUI();
                showToast(`‚úîÔ∏è Nothing NFT minted! TX: ${txHash.slice(0, 10)}...`, 'success');
                addTxLog('mint', { name: `"${randomNftName}"`, cost: gasFee, txHash, success: true });
                setPendingState(false);
            }, 5000 + Math.random() * 5000);
        }

        function updateStats() {
            const statsElements = {
                marketCap: ["Undefined", "Negative", "404 Not Found", "NaN", "Imaginary", "Void"],
                volume24h: ["Emotional Damage", "Tears of Regret", "Lost Dreams", "Wasted Time", "Pure Disappointment", "Existential Crisis"],
                holdersCount: ["Nobody + You", "Just You", "You + Your Alt", "2 Bots", "Error: NaN", "Everyone's Mom"]
            };
            for(const id in statsElements) {
                const el = document.getElementById(id);
                if (el) el.textContent = statsElements[id][Math.floor(Math.random() * statsElements[id].length)];
            }
            const lpVolume = (Math.random() * 0.0001).toFixed(6);
            const lpStates = ["Glitchy Pool", "Broken Pool", "Empty Pool", "Non-Existent Pool"];
            const lpEl = document.getElementById("lpVolume");
            if (lpEl) lpEl.textContent = `${lpVolume} LP (${lpStates[Math.floor(Math.random() * lpStates.length)]})`;

            const randomBlock = Math.floor(Math.random() * 99999999) + 10000000;
            const activityTypes = ["Mint", "Burn", "Transfer", "Swap"];
            const randomActivity = activityTypes[Math.floor(Math.random() * activityTypes.length)];
            const randomTxHashPart = Math.random().toString(16).substr(2, 8);
            const activityEl = document.getElementById("lastActivity");
            if (activityEl) activityEl.textContent = `Block ${randomBlock} - ${randomActivity} (0x${randomTxHashPart}...)`;
        }
        
        function toggleVoidpaper() {
            unlockAchievement('read_the_void');
            toggleSection(document.getElementById('voidpaperSection'));
        }
        function toggleHowToBuySection() { toggleSection(document.getElementById('howToBuySection')); }
        function toggleSection(sectionElement) {
            if (sectionElement.style.display === 'block') {
                sectionElement.style.display = 'none';
            } else {
                sectionElement.style.display = 'block';
                sectionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        function populateMemeWall() {
            const memeGrid = document.getElementById('memeGrid');
            if(!memeGrid) return;
            memeGrid.innerHTML = '';
            memes.forEach(meme => {
                const memeCard = document.createElement('div');
                memeCard.className = 'meme-card';
                memeCard.innerHTML = `
                    <div class="nft-card-content">
                        <div class="nft-image-container"> <img src="${meme.img}" alt="${meme.collection} ${meme.number}" onerror="this.onerror=null;this.src='https://placehold.co/250x250/111111/e63946?text=Error';"> <div class="nft-overlay">${meme.number}</div> </div>
                        <div class="nft-info">
                            <div class="nft-collection">${meme.collection}</div> <div class="nft-price">Price: <span class="price-value">${meme.price}</span></div>
                            <div class="meme-actions"> <button onclick="voteMeme('${meme.id}')">This means NOTHING</button> <button onclick="mintMemeNft('${meme.id}')">${meme.mintText}</button> </div>
                            <div class="meme-votes" id="votes-${meme.id}">Votes: ${meme.votes}</div>
                        </div>
                    </div>`;
                memeGrid.appendChild(memeCard);
            });
        }
        
        function voteMeme(memeId) {
            if (isTransactionPending) return;
            unlockAchievement('voted_in_void');
            const meme = memes.find(m => m.id === memeId);
            if (meme) {
                meme.votes++;
                localStorage.setItem(`meme_votes_${meme.id}`, meme.votes);
                document.getElementById(`votes-${meme.id}`).textContent = `Votes: ${meme.votes}`;
                showToast(`You voted for "${meme.collection} ${meme.number}". Your meaninglessness score increased.`, 'info');
            }
        }

        function mintMemeNft(memeId) { 
            showToast("This feature also leads to nothing... Try minting from the main section.", 'info'); 
        }

        function updateMostNonsensicalMeme() {
            const topMemeDisplay = document.getElementById('mostNonsensicalMeme');
            if (!topMemeDisplay) return;
            if (memes.length === 0) return;
            let topMeme = memes.reduce((prev, current) => (prev.votes > current.votes) ? prev : current);
            if (topMeme.votes > 0) {
                 topMemeDisplay.textContent = `Most Nonsensical NFT Today: "${topMeme.collection} ${topMeme.number}" (Votes: ${topMeme.votes})`;
            } else {
                const defaultMemes = ["Silence is Golden, Duct Tape is Silver", "The Cat Staring at Nothing", "My Brain Cell Count"];
                topMemeDisplay.textContent = `Most Nonsensical Meme Today: "${defaultMemes[Math.floor(Math.random() * defaultMemes.length)]}"`;
            }
        }

        let currentSimulatedPrice = 0.00000068;
        function updateChartData() {
            const fluctuationFactor = (Math.random() - 0.48) * 0.0000001;
            currentSimulatedPrice += fluctuationFactor;
            currentSimulatedPrice = Math.max(0.00000001, currentSimulatedPrice);
            if(document.getElementById("currentKnotPrice")) document.getElementById("currentKnotPrice").textContent = `$${currentSimulatedPrice.toFixed(8)}`;
            if(document.getElementById("currentPrice")) document.getElementById("currentPrice").textContent = `$${currentSimulatedPrice.toFixed(8)}`;
            if (priceChart) {
                const data = priceChart.data.datasets[0].data;
                data.push(currentSimulatedPrice);
                if (data.length > 100) data.shift();
                priceChart.data.labels.push('');
                if (priceChart.data.labels.length > 100) priceChart.data.labels.shift();
                priceChart.update('none');
            }
        }

        function showPopup(actionType) {
            if (isTransactionPending) return;
            
            const now = Date.now();
            popupOpenTimestamps.push(now);
            popupOpenTimestamps = popupOpenTimestamps.filter(ts => now - ts < 120000); // Keep last 2 mins
            if (popupOpenTimestamps.length >= allAchievements.popup_addict.target) {
                incrementAchievementProgress('popup_addict');
            }

            const popupContent = document.getElementById('popupContent');
            popupContent.innerHTML = ''; // Clear previous content

            if (actionType === 'lpBuy') {
                const inputAmount = parseFloat(document.getElementById('buyInputAmount').value);
                const currency = document.getElementById('buyCurrencySelect').value;
                const receiveKnot = parseFloat(document.getElementById('receiveTokenAmount').value.replace(/,/g, ''));

                if (!isWalletConnected) { showToast("Connect wallet first to buy nothing!", 'error'); return; }
                if (isNaN(inputAmount) || inputAmount <= 0) { showToast(`Please enter a valid amount to buy.`, 'error'); return; }
                if (isNaN(receiveKnot) || receiveKnot <= 0) { showToast(`Cannot calculate 0xKNOTHING received. Price might be infinite.`, 'error'); return; }
                
                let hasSufficientBalance = false;
                switch(currency) {
                    case 'ETH': hasSufficientBalance = currentEthBalance >= inputAmount; break;
                    case 'USDT': hasSufficientBalance = currentUsdtBalance >= inputAmount; break;
                    case 'CARD': hasSufficientBalance = currentCardBalance >= inputAmount; break;
                }

                if (!hasSufficientBalance) { showToast(`Insufficient ${currency} balance to perform this transaction.`, 'error'); return; }
                
                popupContent.innerHTML = `
                    <h3>Confirm Buy 0xKNOTHING</h3>
                    <p>Are you sure you want to spend <span style="color:#00ff80;">${inputAmount.toLocaleString()} ${currency}</span> to buy <span style="color:#00ff80;">${receiveKnot.toLocaleString()} 0xKNOTHING</span>?</p>
                    <div class="popup-buttons">
                        <button id="popupConfirmBtn">Confirm</button>
                        <button id="popupCancelBtn" onclick="hidePopup()">Cancel</button>
                    </div>
                `;
                document.getElementById('popupConfirmBtn').onclick = () => { hidePopup(); processLPBuy(inputAmount, currency, receiveKnot); };

            } else if (actionType === 'burn') {
                if (currentKnotBalance <= 0) { return; }
                popupContent.innerHTML = `
                    <h3>Burn 0xKNOTHING to the Void</h3>
                    <p>Select amount to burn. This action is irreversible.</p>
                    <div class="burn-controls">
                        <div class="burn-percentage-buttons">
                            <button onclick="setBurnAmount(0.25)">25%</button>
                            <button onclick="setBurnAmount(0.50)">50%</button>
                            <button onclick="setBurnAmount(0.75)">75%</button>
                            <button onclick="setBurnAmount(1.00)">100%</button>
                        </div>
                        <div class="burn-input-container">
                            <input type="number" id="burnAmountInput" placeholder="0.0" min="0" max="${currentKnotBalance}">
                        </div>
                    </div>
                    <div class="popup-buttons">
                        <button id="popupConfirmBtn">Confirm Burn</button>
                        <button id="popupCancelBtn" onclick="hidePopup()">Cancel</button>
                    </div>
                `;
                document.getElementById('popupConfirmBtn').onclick = () => {
                    const amountToBurn = parseFloat(document.getElementById('burnAmountInput').value);
                    if (isNaN(amountToBurn) || amountToBurn <= 0 || amountToBurn > currentKnotBalance) {
                        showToast('Please enter a valid amount to burn.', 'error');
                        return;
                    }
                    hidePopup(); 
                    burnToVoid(amountToBurn); 
                };
            } else { return; }

            document.getElementById('actionPopup').style.display = 'flex';
        }

        function hidePopup() { document.getElementById('actionPopup').style.display = 'none'; }
        
        function hideTrophyRoom() { document.getElementById('trophyRoomPopup').style.display = 'none'; }
        
        // NEW: Explorer Popup functions
        function showExplorerPopup(txHash) {
            const txData = txHistory.find(tx => tx.txHash === txHash);
            if (!txData) return;
            
            const detailsEl = document.getElementById('explorerDetails');
            const statusHtml = txData.success ? `<span style="color: var(--accent-green);">Success (we think)</span>` : `<span style="color: var(--primary-color);">Failed (as expected)</span>`;

            detailsEl.innerHTML = `
                <p><strong>Status:</strong> ${statusHtml}</p>
                <p><strong>TX Hash:</strong> ${txData.txHash}</p>
                <p><strong>Block:</strong> ${txData.block}</p>
                <p><strong>Timestamp:</strong> ${new Date(txData.timestamp).toLocaleString()}</p>
                <p><strong>From:</strong> ${userAddress.slice(0, 12)}...</p>
                <p><strong>To:</strong> ${txData.type === 'burn' ? '0x000...dEaD' : '0xKNOTHING Contract'}</p>
            `;
            
            document.getElementById('explorerPopup').style.display = 'flex';
        }
        function hideExplorerPopup() { document.getElementById('explorerPopup').style.display = 'none'; }


        function setBurnAmount(percentage) {
            const burnInput = document.getElementById('burnAmountInput');
            if (burnInput) {
                const amount = currentKnotBalance * percentage;
                burnInput.value = amount.toFixed(0);
            }
        }

        function renderTrophyRoom() {
            const grid = document.getElementById('trophyGrid');
            if(!grid) return;
            grid.innerHTML = '';
            updatePofDisplay();

            for (const id in allAchievements) {
                const ach = allAchievements[id];
                const data = userPlayerData.achievements[id];
                const card = document.createElement('div');
                card.className = 'trophy-card ' + (data.unlocked ? 'unlocked' : 'locked');

                let progressHTML = '';
                if (ach.type === 'counter' && !data.unlocked) {
                    const percent = Math.min(100, (data.progress / ach.target) * 100);
                    progressHTML = `<div class="progress-bar"><div class="progress-fill" style="width: ${percent}%;"></div></div>`;
                }
                
                card.innerHTML = `
                    <div class="icon">${data.unlocked ? 'üèÜ' : '‚ùì'}</div>
                    <h4>${ach.name}</h4>
                    <p>${ach.description}</p>
                    ${progressHTML}
                `;
                grid.appendChild(card);
            }
        }

        async function processLPBuy(amountSpent, currencySpent, receivedKnot) {
            setPendingState(true);
            showToast(`Submitting purchase to the void...`, 'info', 10000);

            setTimeout(() => {
                const txHash = "0x" + Math.random().toString(16).substr(2, 64);
                if (Math.random() < 0.1) {
                    showToast("Purchase failed. The void rejected your funds.", 'error');
                    addTxLog('buy', { currency: currencySpent, amount: amountSpent, received: 0, txHash, success: false });
                    setPendingState(false);
                    return;
                }
                
                unlockAchievement('first_buy');

                switch(currencySpent) {
                    case 'ETH': currentEthBalance -= amountSpent; break;
                    case 'USDT': currentUsdtBalance -= amountSpent; break;
                    case 'CARD': currentCardBalance -= amountSpent; break;
                }

                currentKnotBalance += receivedKnot;
                
                const usdValue = amountSpent * SIMULATED_PRICES[currencySpent];
                totalUsdRaised += usdValue;
                totalTokensSold += receivedKnot;
                localStorage.setItem('0xknothing_usdRaised_v3', totalUsdRaised);
                localStorage.setItem('0xknothing_tokensSold_v3', totalTokensSold);

                updateWalletUI();
                updateLPInterface();
                showToast(`‚úîÔ∏è Successfully bought ${receivedKnot.toLocaleString()} 0xKNOTHING!`, 'success');
                addTxLog('buy', { currency: currencySpent, amount: amountSpent, received: receivedKnot, txHash, success: true });

                setPendingState(false);
            }, 5000 + Math.random() * 5000);
        }

        async function burnToVoid(amountToBurn) {
            setPendingState(true);
            showToast(`Sending your tokens to the void...`, 'info', 10000);
            
            setTimeout(() => {
                const txHash = "0x" + Math.random().toString(16).substr(2, 64);
                if (Math.random() < 0.1) {
                    showToast("Burn failed. The void refuses your sacrifice.", 'error');
                    addTxLog('burn', { amount: amountToBurn, txHash, success: false });
                    setPendingState(false);
                    return;
                }
                
                unlockAchievement('first_burn');
                currentKnotBalance -= amountToBurn;
                updateWalletUI();
                showToast(`‚úîÔ∏è Successfully burned ${amountToBurn.toLocaleString()} 0xKNOTHING!`, 'success');
                addTxLog('burn', { amount: amountToBurn, txHash, success: true });
                
                setPendingState(false);
            }, 5000 + Math.random() * 5000);
        }
        
        function createParticles() {
            const container = document.getElementById("particles");
            if (!container) return;
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement("div");
                particle.className = "particle";
                particle.style.left = Math.random() * 100 + "%";
                particle.style.animationDelay = Math.random() * 20 + "s";
                particle.style.animationDuration = (15 + Math.random() * 10) + "s";
                container.appendChild(particle);
            }
        }
        
        function updateRealtimeCountdown() {
            const countdownEl = document.getElementById("countdownDisplay");
            if(!countdownEl) return;
            const now = new Date();
            const endOfDay = new Date(now);
            endOfDay.setUTCHours(23, 59, 59, 999);
            let timeLeft = endOfDay.getTime() - now.getTime();

            if (timeLeft <= 1000) { // Check if we are at the turn of the day
                // This block will run once when the day changes
                if (!window.dayChanged) {
                    currentStage++;
                    localStorage.setItem('0xknothing_currentStage_v3', currentStage);
                    knotPrice = calculateKnotPrice(currentStage);
                    updateLPInterface();
                    let stageName = stageNames[(currentStage - 1) % stageNames.length];
                    showToast(`Void transitioned to ${stageName}! Embrace the new nothingness.`, 'info');
                    window.dayChanged = true; 
                    setTimeout(() => { window.dayChanged = false; }, 2000); // Reset flag after 2s
                }
            }
            let h = Math.floor(timeLeft / (1000 * 60 * 60));
            let m = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            let s = Math.floor((timeLeft % (1000 * 60)) / 1000);
            countdownEl.textContent = `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }
        
        function initializeChart() {
            const ctx = document.getElementById('priceChart')?.getContext('2d');
            if(!ctx) return;
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(100).fill(''),
                    datasets: [{
                        label: '0xKNOTHING/USDT', data: Array(100).fill(0.00000068),
                        borderColor: '#00ff80', backgroundColor: 'rgba(0, 255, 128, 0.2)',
                        borderWidth: 2, fill: true, tension: 0.4, pointRadius: 0
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { display: false },
                        y: { ticks: { color: '#aaa', callback: value => '$' + value.toFixed(8) }, grid: { color: 'rgba(255, 255, 255, 0.05)' } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { label: context => `$${context.parsed.y.toFixed(8)}` } }
                    }
                }
            });
        }
        
        // --- NEW FUNCTIONS ---
        
        function updateOracleFeed() {
            const oracleEl = document.getElementById('oracleMessage');
            if (oracleEl) {
                oracleEl.textContent = oracleMessages[Math.floor(Math.random() * oracleMessages.length)];
            }
        }
        
        function spreadFud() {
            if (isTransactionPending) return;
            unlockAchievement('fud_initiator');
            showToast(`FUD: ${fudMessages[Math.floor(Math.random() * fudMessages.length)]}`, 'error', 6000);
        }
        
        function handleLpAction() {
            if (!isWalletConnected) {
                connectWallet();
                return;
            }
            const currency = document.getElementById('buyCurrencySelect').value;
            if (currency !== 'ETH' && !approvedCurrencies[currency]) {
                processApprove(currency);
            } else {
                showPopup('lpBuy');
            }
        }
        
        function updateLpActionButton() {
            const lpActionBtn = document.getElementById('lpActionBtn');
            if (!isWalletConnected) {
                lpActionBtn.textContent = 'CONNECT WALLET';
                lpActionBtn.classList.remove('approve-btn');
                lpActionBtn.onclick = () => connectWallet();
                return;
            }
            
            const currency = document.getElementById('buyCurrencySelect').value;
            if (currency !== 'ETH' && !approvedCurrencies[currency]) {
                lpActionBtn.textContent = `APPROVE ${currency}`;
                lpActionBtn.classList.add('approve-btn');
            } else {
                lpActionBtn.textContent = 'BUY NOTHING';
                lpActionBtn.classList.remove('approve-btn');
            }
            lpActionBtn.onclick = handleLpAction;
        }
        
        function processApprove(currency) {
            if (isTransactionPending) return;
            setPendingState(true);
            showToast(`Requesting approval for ${currency}...`, 'info', 8000);
            
            setTimeout(() => {
                setPendingState(false);
                if (Math.random() < 0.1) {
                    showToast(`Approval failed. The void doesn't want your ${currency}.`, 'error');
                    return;
                }
                
                approvedCurrencies[currency] = true;
                localStorage.setItem('0xknothing_approvedCurrencies_v3', JSON.stringify(approvedCurrencies));
                showToast(`‚úîÔ∏è ${currency} approved for nothing. You may now proceed to buy.`, 'success');
                updateLpActionButton();
            }, 3000 + Math.random() * 2000);
        }
        
        function addTxLog(type, details) {
            const newTx = {
                ...details,
                type: type,
                timestamp: Date.now(),
                block: Math.floor(Math.random() * 1000000) + 18000000
            };
            txHistory.unshift(newTx);
            if (txHistory.length > 50) txHistory.pop();
            localStorage.setItem('0xknothing_txHistory_v3', JSON.stringify(txHistory));
            renderTxHistory();
        }
        
        function renderTxHistory() {
            const container = document.getElementById('txLogContainer');
            if (!container || !isWalletConnected) return;

            if (txHistory.length === 0) {
                container.innerHTML = '<p style="text-align:center; color: #777;">No history of nothingness yet.</p>';
                return;
            }

            container.innerHTML = txHistory.map(tx => {
                let detailsText = '';
                let typeClass = '';
                switch (tx.type) {
                    case 'buy':
                        typeClass = 'tx-type-buy';
                        detailsText = `Bought ${tx.received.toLocaleString()} 0xKNOTHING ‚Äî Cost ${tx.amount.toFixed(4)} ${tx.currency}`;
                        break;
                    case 'burn':
                        typeClass = 'tx-type-burn';
                        detailsText = `Burned ${tx.amount.toLocaleString()} 0xKNOTHING`;
                        break;
                    case 'mint':
                        typeClass = 'tx-type-mint';
                        detailsText = `Minted NFT ${tx.name} ‚Äî Cost ${tx.cost.toFixed(4)} ETH`;
                        break;
                }
                if (!tx.success) detailsText += ' (Failed)';
                
                return `
                    <div class="tx-log-entry">
                        <span class="details"><strong class="${typeClass}">${tx.type.toUpperCase()}:</strong> ${detailsText}</span>
                        <a class="explorer-link" onclick="showExplorerPopup('${tx.txHash}')">TX: ${tx.txHash.slice(0,6)}...${tx.txHash.slice(-4)}</a>
                    </div>
                `;
            }).join('');
        }
        
        function toggleDarkMode() {
            unlockAchievement('dark_mode_connoisseur');
            const btn = document.getElementById('darkModeToggle');
            const modes = ["Darkmode", "Slightly Less Darkmode", "Void Mode", "Even Darker Mode", "Darkmode (For Real this time)"];
            let currentModeIndex = modes.indexOf(btn.textContent);
            let nextModeIndex = (currentModeIndex + 1) % modes.length;
            btn.textContent = modes[nextModeIndex];
            showToast("Theme updated. The void is now 0.01% more... void.", "info");
        }

    </script>
</body>
</html>
